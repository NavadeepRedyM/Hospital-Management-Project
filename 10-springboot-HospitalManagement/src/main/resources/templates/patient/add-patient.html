<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Add Patient</title>
  <style>
    body { font-family: sans-serif; background-color: #f4f7f6; }
    .error { color: #c0392b; font-size: 13px; margin-top: 4px; }
    .field { margin-bottom: 15px; }
    input[type="text"], input[type="email"], input[type="number"], select { 
        width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box;
    }
    .btn { padding: 10px 18px; border-radius: 4px; cursor: pointer; text-decoration: none; display: inline-block; }
    .btn-save { background-color: #27ae60; color: white; border: none; }
    .btn-cancel { background-color: #95a5a6; color: white; margin-left: 10px; }
  </style>
</head>
<body>
<div style="max-width:560px;margin:30px auto;background:#fff;padding:30px;border-radius:8px;box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
  <h2 style="margin-top:0;">Add Patient Profile</h2>

  <form th:action="@{/admin/patients/save}" th:object="${patient}" method="post">
    
    <!-- 1. Username Dropdown (The Logical Link) -->
    <div class="field">
      <label><strong>Link to User Account</strong></label>
      <select th:field="*{username}" required>
        <option value="">-- Select a Registered Username --</option>
        <option th:each="u : ${usernames}" th:value="${u}" th:text="${u}"></option>
      </select>
      <div class="error" th:if="${#fields.hasErrors('username')}" th:errors="*{username}"></div>
    </div>

    <!-- 2. Full Name -->
    <div class="field">
      <label>Full Name</label>
      <input type="text" th:field="*{name}" placeholder="Enter full legal name" required />
      <div class="error" th:if="${#fields.hasErrors('name')}" th:errors="*{name}"></div>
    </div>

    <!-- 3. Age -->
    <div class="field">
      <label>Age</label>
      <input type="number" th:field="*{age}" placeholder="e.g. 25" />
      <div class="error" th:if="${#fields.hasErrors('age')}" th:errors="*{age}"></div>
    </div>

    <!-- 4. Gender -->
    <div class="field">
      <label>Gender</label>
      <input type="text" th:field="*{gender}" placeholder="Male/Female/Other" />
      <div class="error" th:if="${#fields.hasErrors('gender')}" th:errors="*{gender}"></div>
    </div>

    <!-- 5. Contact Number -->
    <div class="field">
      <label>Contact Number</label>
      <input type="text" th:field="*{contactNumber}" inputmode="numeric" pattern="^[0-9]{10}$" maxlength="10" placeholder="10-digit number" oninput="this.value=this.value.replace(/[^0-9]/g,'');" />
      <small>Exactly 10 digits required.</small>
      <div class="error" th:if="${#fields.hasErrors('contactNumber')}" th:errors="*{contactNumber}"></div>
    </div>

    <!-- 6. Email -->
    <div class="field">
      <label>Email</label>
      <input type="email" th:field="*{email}" placeholder="example@gmail.com" />
      <small>Must be a valid Gmail address.</small>
      <div class="error" th:if="${#fields.hasErrors('email')}" th:errors="*{email}"></div>
    </div>

    <!-- 7. Address -->
    <div class="field">
      <label>Address</label>
      <input type="text" th:field="*{address}" placeholder="Residential address" />
      <div class="error" th:if="${#fields.hasErrors('address')}" th:errors="*{address}"></div>
    </div>

    <!-- 8. Blood Group -->
    <div class="field">
      <label>Blood Group</label>
      <input type="text" th:field="*{bloodGroup}" placeholder="e.g. O+, A-" />
      <div class="error" th:if="${#fields.hasErrors('bloodGroup')}" th:errors="*{bloodGroup}"></div>
    </div>

    <div style="margin-top: 20px;">
      <button class="btn btn-save" type="submit">Create Patient Profile</button>
      <a th:href="@{/admin/patients}" class="btn btn-cancel">Cancel</a>
    </div>
  </form>
</div>
</body>
</html>
