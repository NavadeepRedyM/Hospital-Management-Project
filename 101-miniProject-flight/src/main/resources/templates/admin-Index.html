<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flight Management 2026 - Admin</title>
    <!-- Bootstrap 5.3 CDN -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body class="bg-light">

<div class="container py-5">
    <!-- Logout Section -->
    <div class="text-end mb-2">
        <form th:action="@{/home/logout}" method="post" style="display: inline;">
            <button type="submit" class="btn btn-link text-decoration-none text-muted small p-0">Logout</button>
        </form>
    </div>

    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 style="color: #FF1493;">Flight Management System</h2>
        <!-- PINK ADD BUTTON -->
        <a th:href="@{/home/add}" class="btn text-white fw-bold" 
           style="background-color: #FF69B4 !important; border: none !important; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
           + Add New Flight
        </a>
    </div>

    <!-- Search Form (Filtering Logic) -->
    <div class="card shadow-sm mb-4 border-0">
        <div class="card-body">
            <!-- th:action matches the search method in your Controller -->
            <form th:action="@{/home/search}" method="get" class="row g-3">
                <div class="col-md-4">
                    <input type="text" name="pickUp" class="form-control" placeholder="From (Pick Up)">
                </div>
                <div class="col-md-4">
                    <input type="text" name="destination" class="form-control" placeholder="To (Destination)">
                </div>
                <div class="col-md-4">
                    <!-- PINK OUTLINE SEARCH BUTTON -->
                    <button type="submit" class="btn fw-bold w-100" 
                            style="border: 2px solid #FF69B4 !important; color: #FF69B4 !important;">
                        Search Flights
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Flight Table (Using FlightDTO Fields) -->
    <div class="card shadow-sm border-0">
        <div class="card-body p-0">
            <table class="table table-hover align-middle mb-0">
                <!-- PINK TABLE HEADER -->
                <thead style="background-color: #FF69B4 !important; color: white !important;">
                    <tr>
                        <th class="py-3 ps-3">Airline</th>
                        <th class="py-3">Route</th>
                        <th class="py-3">Date & Time</th>
                        <th class="py-3">Class</th>
                        <th class="py-3">Price</th>
                        <th class="py-3 text-center">Seats</th>
                        <th class="py-3 text-center">Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Iterating over the DTO list -->
                    <tr th:each="f : ${flights}">
                        <!-- DTO Mapping: airlineName -->
                        <td th:text="${f.airlineName}" class="fw-bold ps-3"></td>
                        
                        <!-- DTO Mapping: pickUp and destination -->
                        <td>
                            <span th:text="${f.pickUp}" class="text-secondary"></span> 
                            <span class="mx-1">âž”</span> 
                            <span th:text="${f.destination}" class="text-secondary"></span>
                        </td>
                        
                        <!-- Date Formatting -->
                        <td th:text="${#dates.format(f.departureDate, 'dd MMM yyyy HH:mm')}"></td>
                        
                        <!-- DTO Mapping: flightClass -->
                        <td>
                            <span class="badge" style="background-color: #FFC0CB; color: #D81B60;" 
                                  th:text="${f.flightClass}"></span>
                        </td>
                        
                        <!-- Price Formatting -->
                        <td th:text="${'$' + #numbers.formatDecimal(f.price, 1, 2)}" class="fw-bold text-dark"></td>
                        
                        <!-- Seats Mapping -->
                        <td th:text="${f.availableSeats}" class="text-center"></td>
                        
                        <td class="text-center">
                            <div class="btn-group">
                                <!-- UPDATE BUTTON (Using fId from DTO) -->
                                <a th:href="@{/home/edit/{fid}(fid=${f.fId})}" 
                                   class="btn btn-sm btn-outline-warning">Edit</a>
                                
                                <!-- DELETE BUTTON (Using fId from DTO) -->
                                <a th:href="@{/home/delete/{fid}(fid=${f.fId})}" 
                                   class="btn btn-sm btn-outline-danger"
                                 >Delete</a>
                            </div>
                        </td>
                    </tr>
                    <!-- Empty State -->
                    <tr th:if="${#lists.isEmpty(flights)}">
                        <td colspan="7" class="text-center text-muted py-5">
                            No flights currently available in the system.
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    
    <footer class="mt-5 text-center">
        <p class="text-muted small">&copy; 2026 Flight Orchestration Layered System</p>
    </footer>
</div>

<!-- Bootstrap JS and dependencies -->
<script src="https://cdn.jsdelivr.net"></script>
</body>
</html>
